<%
  contains_urls = Cms::Page.site(@cur_site).and_linking_pages(item)
  delete_alert_enabled = @cur_user.cms_role_permit_any?(@cur_site, %w(delete_cms_ignore_alert)) && contains_urls.present?
  has_branch_page = (item.branches.present? || item.branch?)
  if contains_urls.present?
    if delete_alert_enabled
      check_state = "unchecked"
    elsif has_branch_page
      check_state = "hide"
    else
      check_state = "disabled" # when pages other than branch page present or linked 
    end
  else
    if has_branch_page 
      check_state = "hide"
    else
      check_state = "checked"
    end
  end
%>
<li class="list-item" data-id="<%= item.id %>">
  <label class="check">
    <% case check_state %>
      <% when "unchecked" %>
        <%= f.check_box_tag 'ids[]', item.id.to_s, false %>
      <% when "checked" %>
        <%= f.check_box_tag 'ids[]', item.id.to_s, checked: true %>
      <%# No need to show anything for "hide" and "disabled" states %>
    <% end %>
  </label>
  <div class="info">
    <% item_url = url_for({ action: :show, id: item }) rescue nil %>
    <% if item_url %>
      <%= link_to item.name, item_url, class: "title", target: "_blank", rel: "noopener" %>
    <% else %>
      <%= item.name %>
    <% end %>
    <div class="meta">
      <%= render "cms/crud/destroy_info", item: item %>
      <% case check_state %>
        <% when "unchecked" %>
          <%= link_to t("ss.confirm.contains_links_in_file_ignoring_alert"), { action: :contains_urls, id: item },
            class: "contains-urls", target: :_blank, rel: "noopener" rescue nil %>
        <% when "checked" %>
          <%= t("ss.confirm.not_contains_links_in_file") %>
        <% when "disabled" %>
          <%= link_to t("ss.confirm.contains_links_in_file"), { action: :contains_urls, id: item },
            class: "contains-urls", target: :_blank, rel: "noopener" rescue nil %>
        <% when "hide" %>
          <%= t("ss.confirm.unable_to_delete_due_to_branch_page") %>
      <% end %>
    </div>
  </div>
</li>
